!function(){function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function e(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t(e,n)}}function n(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n,r,o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var a=[],l=!0,i=!1;try{for(o=o.call(t);!(l=(n=o.next()).done)&&(a.push(n.value),!e||a.length!==e);l=!0);}catch(t){i=!0,r=t}finally{try{l||null==o.return||o.return()}finally{if(i)throw r}}return a}}(t,n)||e(t,n)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(n){return function(e){if(Array.isArray(e))return t(e)}(n)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||e(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}var a=new(function(){var t;function e(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),this.initialState=t,this.messageStart=document.querySelector(".message-start"),this.messageLose=document.querySelector(".message-lose"),this.messageWin=document.querySelector(".message-win"),this.startActive=!1,this.score=0}return t=[{key:"moveLeft",value:function(){var t=this,e=r(document.querySelector("tbody").children);"playing"===this.getStatus()&&e.forEach(function(e){var n=[],a=function(t,e,r){for(var a=function(t){if(n.some(function(e){return e.cellIndex===t&&e.cellContent!==r}))return{v:!1}},l=t+1;l<e;l++){var i=a(l);if("object"===o(i))return i.v}return!0};r(e.children).forEach(function(e,r){var o={},l=parseInt(e.textContent);if(l){var i=n.find(function(t){return t.cellContent===l&&!0===a(t.cellIndex,r,l)&&t.mergeTry<1});i?(i.cellContent+=l,i.mergeTry++,t.score+=i.cellContent):(o.cellIndex=r,o.cellContent=l,o.mergeTry=0,n.push(o));var c=document.createElement("td");c.classList.add("field-cell"),e.replaceWith(c)}}),0!==n.length&&n.forEach(function(n){var o=!0,a=!1,l=void 0;try{for(var i,c=r(e.children)[Symbol.iterator]();!(o=(i=c.next()).done);o=!0){var s=i.value;if(!s.textContent){s.textContent=n.cellContent,s.classList.add("field-cell--".concat(n.cellContent)),2048===n.cellContent&&(t.messageWin.classList.remove("hidden"),t.startActive=!1);break}}}catch(t){a=!0,l=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw l}}})})}},{key:"moveRight",value:function(){var t=this,e=r(document.querySelector("tbody").children);"playing"===this.getStatus()&&e.forEach(function(e){var n=[],a=function(t,e,r){for(var a=function(t){if(n.some(function(e){return e.cellIndex===t&&e.cellContent!==r}))return{v:!1}},l=t+1;l<e;l++){var i=a(l);if("object"===o(i))return i.v}return!0};r(e.children).reverse().forEach(function(e,r){var o={},l=parseInt(e.textContent);if(l){var i=n.find(function(t){return t.cellContent===l&&!0===a(t.cellIndex,r,l)&&t.mergeTry<1});i?(i.cellContent+=l,i.mergeTry++,t.score+=i.cellContent):(o.cellIndex=r,o.cellContent=l,o.mergeTry=0,n.push(o));var c=document.createElement("td");c.classList.add("field-cell"),e.replaceWith(c)}}),0!==n.length&&n.forEach(function(n){var o=!0,a=!1,l=void 0;try{for(var i,c=r(e.children).reverse()[Symbol.iterator]();!(o=(i=c.next()).done);o=!0){var s=i.value;if(!s.textContent){s.textContent=n.cellContent,s.classList.add("field-cell--".concat(n.cellContent)),2048===n.cellContent&&(t.messageWin.classList.remove("hidden"),t.startActive=!1);break}}}catch(t){a=!0,l=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw l}}})})}},{key:"moveUp",value:function(){var t=this,e=r(document.querySelector("tbody").children),a=[],l=function(t,e,n,r){for(var l=function(e){if(a.some(function(n){return n.rowIndex===e&&n.cellIndex===t&&n.cellContent!==r}))return{v:!1}},i=e+1;i<n;i++){var c=l(i);if("object"===o(c))return c.v}return!0};"playing"===this.getStatus()&&(e.forEach(function(e,n){r(e.children).forEach(function(e,r){var o={},i=parseInt(e.textContent);if(i){var c=a.find(function(t){return t.cellIndex===r&&t.cellContent===i&&!0===l(r,t.rowIndex,n,i)});c?(c.cellContent+=i,t.score+=c.cellContent):(o.rowIndex=n,o.cellIndex=r,o.cellContent=i,a.push(o));var s=document.createElement("td");s.classList.add("field-cell"),e.replaceWith(s)}})}),a.forEach(function(r){var o=!0,a=!1,l=void 0;try{for(var i,c=Object.entries(r)[Symbol.iterator]();!(o=(i=c.next()).done);o=!0){var s=n(i.value,2),u=s[0],f=s[1],d=!0,v=!1,h=void 0;if("cellIndex"===u)try{for(var y,m=e[Symbol.iterator]();!(d=(y=m.next()).done);d=!0){var g=y.value,S=parseInt(f)+1,b=g.querySelector("*:nth-child(".concat(S,")"));if(!b.textContent){b.textContent=r.cellContent,b.classList.add("field-cell--".concat(r.cellContent)),2048===r.cellContent&&(t.messageWin.classList.remove("hidden"),t.startActive=!1);break}}}catch(t){v=!0,h=t}finally{try{d||null==m.return||m.return()}finally{if(v)throw h}}}}catch(t){a=!0,l=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw l}}}))}},{key:"moveDown",value:function(){var t=this,e=r(document.querySelector("tbody").children).reverse(),a=[],l=function(t,e,n,r){for(var l=function(e){if(a.some(function(n){return n.rowIndex===e&&n.cellIndex===t&&n.cellContent!==r}))return{v:!1}},i=e+1;i<n;i++){var c=l(i);if("object"===o(c))return c.v}return!0};"playing"===this.getStatus()&&(e.forEach(function(e,n){r(e.children).forEach(function(e,r){var o={},i=parseInt(e.textContent);if(i){var c=a.find(function(t){return t.cellIndex===r&&t.cellContent===i&&!0===l(r,t.rowIndex,n,i)});c?(c.cellContent+=i,t.score+=c.cellContent):(o.rowIndex=n,o.cellIndex=r,o.cellContent=i,a.push(o));var s=document.createElement("td");s.classList.add("field-cell"),e.replaceWith(s)}})}),a.forEach(function(r){var o=!0,a=!1,l=void 0;try{for(var i,c=Object.entries(r)[Symbol.iterator]();!(o=(i=c.next()).done);o=!0){var s=n(i.value,2),u=s[0],f=s[1],d=!0,v=!1,h=void 0;if("cellIndex"===u)try{for(var y,m=e[Symbol.iterator]();!(d=(y=m.next()).done);d=!0){var g=y.value,S=parseInt(f)+1,b=g.querySelector("*:nth-child(".concat(S,")"));if(!b.textContent){b.textContent=r.cellContent,b.classList.add("field-cell--".concat(r.cellContent)),2048===r.cellContent&&(t.messageWin.classList.remove("hidden"),t.startActive=!1);break}}}catch(t){v=!0,h=t}finally{try{d||null==m.return||m.return()}finally{if(v)throw h}}}}catch(t){a=!0,l=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw l}}}))}},{key:"getScore",value:function(){var t=document.querySelector(".game-score");return this.startActive||(this.score=0),t.textContent=this.score,this.score}},{key:"getState",value:function(){var t=r(document.querySelector("tbody").children);this.initialState=t.map(function(t){return r(t.children).map(function(t){var e=parseInt(t.textContent);return e||(e=0),e})})}},{key:"getStatus",value:function(){var t="";return!1===this.startActive&&(t="idle"),!0===this.startActive&&(t="playing"),this.messageWin.classList.contains("hidden")||(t="win"),this.messageLose.classList.contains("hidden")||(t="lose"),t}},{key:"start",value:function(){this.messageStart.classList.add("hidden"),this.switchButton(),this.startActive=!0,this.addTiles(2)}},{key:"restart",value:function(){var t=r(document.querySelector("tbody").children);this.messageStart.classList.remove("hidden"),this.messageLose.classList.add("hidden"),t.forEach(function(t){r(t.children).forEach(function(t){var e=document.createElement("td");e.classList.add("field-cell"),t.replaceWith(e)})}),this.startActive=!1,this.switchButton(),this.getScore()}},{key:"switchButton",value:function(){var t=document.querySelector(".button");t.classList.contains("restart")?(t.classList.replace("restart","start"),t.textContent="Start"):(t.classList.replace("start","restart"),t.textContent="Restart")}},{key:"generateTiles",value:function(){var t={2:.9,4:.1},e=0;for(var n in t)e+=t[n];return function(){var n=Math.random()*e;for(var r in t)if((n-=t[r])<=0)return r}()}},{key:"addTiles",value:function(t){var e=r(document.querySelector("tbody").children),n=[];e.forEach(function(t){r(t.children).forEach(function(t){t.textContent||n.push(t)})});for(var o=0;o<t;o++){var a=Math.floor(Math.random()*n.length),l=n[a],i=this.generateTiles();l.textContent=i,l.classList.add("field-cell--".concat(i)),n.splice(a,1)}}},{key:"hasEmptyCell",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,o=this.initialState[Symbol.iterator]();!(t=(r=o.next()).done);t=!0)if(r.value.some(function(t){return 0===t}))return!0}catch(t){e=!0,n=t}finally{try{t||null==o.return||o.return()}finally{if(e)throw n}}return!1}}],function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(e.prototype,t),e}()),l=document.querySelector("body"),i=document.querySelector(".button");i.addEventListener("click",function(){i.classList.contains("start")?a.start():i.classList.contains("restart")&&a.restart()}),l.addEventListener("keydown",function(t){a.getState();var e=JSON.stringify(a.initialState);switch(t.key){case"ArrowUp":a.moveUp();break;case"ArrowDown":a.moveDown();break;case"ArrowLeft":a.moveLeft();break;case"ArrowRight":a.moveRight()}a.getState(),e!==JSON.stringify(a.initialState)&&a.addTiles(1),a.hasEmptyCell()||a.messageLose.classList.remove("hidden"),a.getScore()})}();
//# sourceMappingURL=index.846555ea.js.map
